<script>
  function load_comment(){
    if(!document.getElementById("waline_container"))return;
    stellar.loadScript('<%- theme.comments.waline.js %>', {defer:true}).then(function () {
      const el = document.getElementById("waline_container");
      var path = el.getAttribute('comment_id');
      const placeholder = "<%= theme.comments.waline.placeholder %>";
      if (!path) {
        path = decodeURI(window.location.pathname);
      }
      const serverURL = "<%= theme.comments.waline.serverURL %>";
      const locale = {
        nick : "<%= theme.comments.waline.locale.nick %>",
        mail : "<%= theme.comments.waline.locale.mail %>",
        link : "<%= theme.comments.waline.locale.link %>",
        admin: "<%= theme.comments.waline.locale.admin %>",
      }
      Waline.init({
        el: '#waline_container',
        serverURL: serverURL,
        avatar: "<%= theme.comments.waline.avatar %>",
        placeholder: "<%= theme.comments.waline.placeholder %>",
        emoji: ["<%= theme.comments.waline.emoji %>"],
        locale,
      });
    });
  }
  window.addEventListener('DOMContentLoaded', (event) => {
    console.log('DOM fully loaded and parsed');
    load_comment();
  });

</script>
